version: '3.8'

services:
  vicky-app:
    volumes:
      # Mount source code for development
      - .:/app
      - /app/__pycache__
    environment:
      - FLASK_ENV=development
      - DEBUG=1
    command: |
      sh -c "pip install watchdog &&
             watchmedo auto-restart --directory=/app --pattern=*.py --recursive -- 
             gunicorn vicky_app:app -w 1 -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000 --reload"
